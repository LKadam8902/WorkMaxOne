<div class="team-lead-dashboard">
  <!-- Enhanced Sidebar -->
  <div class="sidebar" [class.collapsed]="!showSidebar">    <div class="sidebar-header" [class.clickable]="!showSidebar">
      <div 
        class="dashboard-icon" 
        [title]="showSidebar ? 'Dashboard' : 'Click to expand sidebar'"
        (click)="!showSidebar && openSidebar()">ðŸ“Š</div>
      <button 
        *ngIf="showSidebar"
        class="toggle-sidebar-btn" 
        (click)="closeSidebar()" 
        title="Close Sidebar">
        â—€
      </button>
    </div>
    
    <!-- Tasks Section in Sidebar -->
    <div class="sidebar-content" *ngIf="showSidebar">
      <div class="sidebar-section">
        <h3 class="sidebar-title">
          All Tasks
          <button class="debug-load-btn" (click)="loadTasks()" title="Debug: Load Tasks">
            ðŸ”„
          </button>
        </h3>
        
        <!-- Loading indicator -->
        <div *ngIf="isLoadingTasks" class="sidebar-loading">
          <div class="loading-spinner"></div>
          <span>Loading tasks...</span>
        </div>
          <!-- Tasks list -->
        <div *ngIf="!isLoadingTasks && tasks.length > 0" class="tasks-list">
          <div *ngFor="let task of tasks; trackBy: trackByTaskId" class="task-item">
            <div class="task-info">
              <h4 class="task-name">{{ task.name }}</h4>
              <p class="task-skills">{{ getTaskSkills(task) }}</p>
              <span class="task-status" [class]="'status-' + getTaskStatus(task)">
                {{ getTaskStatusDisplay(task) }}
              </span>
            </div>
            <button 
              *ngIf="isTaskPending(task)" 
              (click)="assignTask(getTaskId(task))" 
              class="assign-task-btn"
              title="Assign this task">
              Assign
            </button>
          </div>
        </div>
          <!-- No tasks message -->
        <div *ngIf="!isLoadingTasks && tasks.length === 0" class="no-tasks">
          <p>No tasks created yet.</p>
          <small>Create your first task using the form.</small>
          <div class="debug-info">
            <strong>Debug Info:</strong><br>
            Tasks array length: {{ tasks.length }}<br>
            Is loading: {{ isLoadingTasks }}<br>
            Show sidebar: {{ showSidebar }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main content -->
  <div class="main-content">
    <!-- Top bar -->
    <div class="top-bar">
      <img src="./logo11.png" alt="WorkMax Logo" class="logo-image" />
      <div class="top-bar-actions">
        <div class="profile-dropdown">
          <img src="./icon.jpg" alt="Profile" class="profile-icon" />
          <div class="dropdown-menu">
            <p>Team Lead</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Messages -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
      <button *ngIf="errorMessage.includes('session') || errorMessage.includes('log in')" 
              (click)="redirectToLogin()" 
              class="login-btn">
        Go to Login
      </button>
    </div>
    <div *ngIf="successMessage" class="success-message">{{ successMessage }}</div>
    <div *ngIf="isLoading" class="loading-message">Loading...</div>

    <!-- Progress indicator -->
    <div class="progress-steps">
      <div class="step" [class.active]="currentStep === 'project'" [class.completed]="hasExistingProject">
        <span class="step-number">1</span>
        <span class="step-label">Create Project</span>
      </div>
      <div class="step" [class.active]="currentStep === 'task'" [class.completed]="currentStep === 'complete'">
        <span class="step-number">2</span>
        <span class="step-label">Add Task</span>
      </div>
      <div class="step" [class.active]="currentStep === 'complete'">
        <span class="step-number">3</span>
        <span class="step-label">Complete</span>
      </div>
    </div>

    <!-- Step 1: Create Project -->
    <div *ngIf="currentStep === 'project'" class="step-content">
      <h2>Create Your Project</h2>
      <p>Start by creating a new project. You can only create one project as a team lead.</p>
      
      <div class="form-group">
        <label for="projectName">Project Name:</label>
        <input 
          id="projectName"
          type="text" 
          [(ngModel)]="projectName" 
          placeholder="Enter project name"
          [disabled]="isLoading"
          class="form-input" />
      </div>
      
      <button 
        (click)="onProjectSubmit()" 
        [disabled]="isLoading || !projectName.trim()"
        class="primary-btn">
        {{ isLoading ? 'Creating...' : 'Create Project' }}
      </button>
    </div>

    <!-- Step 2: Add Task -->
    <div *ngIf="currentStep === 'task'" class="step-content">
      <h2>Add a Task</h2>
      <p *ngIf="!hasExistingProject">Great! Your project has been created. Now add your first task.</p>
      <p *ngIf="hasExistingProject">Add a new task to your existing project.</p>
      
      <div class="form-group">
        <label for="taskName">Task Name:</label>
        <input 
          id="taskName"
          type="text" 
          [(ngModel)]="taskName" 
          placeholder="Enter task name"
          [disabled]="isLoading"
          class="form-input" />
      </div>
      
      <div class="form-group">
        <label for="skills">Required Skills:</label>
        <input 
          id="skills"
          type="text" 
          [(ngModel)]="skills" 
          placeholder="Enter skills separated by commas (e.g., Java, Spring, Angular)"
          [disabled]="isLoading"
          class="form-input" />
        <small class="form-help">Enter the skills required for this task, separated by commas</small>
      </div>
      
      <button 
        (click)="onTaskSubmit()" 
        [disabled]="isLoading || !taskName.trim() || !skills.trim()"
        class="primary-btn">
        {{ isLoading ? 'Creating...' : 'Create Task' }}
      </button>
    </div>

    <!-- Step 3: Complete -->
    <div *ngIf="currentStep === 'complete'" class="step-content">
      <h2>âœ… Task Created Successfully!</h2>
      <p>Your task has been created and is now available for assignment to team members.</p>
      
      <div class="completion-actions">
        <button (click)="createAnotherTask()" class="primary-btn">
          Add Another Task
        </button>
        <button (click)="redirectToLogin()" class="secondary-btn">
          Back to Dashboard
        </button>
      </div>
    </div>
  </div>
</div>
